<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.64">
<link rel="search" type="application/opensearchdescription+xml" title="TryHackMe Documentation" href="/opensearch.xml"><title data-react-helmet="true">OpenVPN Troubleshooting | TryHackMe Documentation</title><meta data-react-helmet="true" name="docsearch:version" content="current,latest"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="OpenVPN Troubleshooting | TryHackMe Documentation"><meta data-react-helmet="true" name="description" content="Using the THM troubleshooting Script:"><meta data-react-helmet="true" property="og:description" content="Using the THM troubleshooting Script:"><meta data-react-helmet="true" property="og:url" content="https://docs.tryhackme.com/docs/openvpn/troubleshooting/openvpn-troubleshooting"><link data-react-helmet="true" rel="shortcut icon" href="/img/thm-favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://docs.tryhackme.com/docs/openvpn/troubleshooting/openvpn-troubleshooting"><link rel="stylesheet" href="/styles.45ef8429.css">
<link rel="preload" href="/styles.6be1d236.js" as="script">
<link rel="preload" href="/runtime~main.40f7df4b.js" as="script">
<link rel="preload" href="/main.8aab2a65.js" as="script">
<link rel="preload" href="/1.e2bdedb4.js" as="script">
<link rel="preload" href="/2.4507b645.js" as="script">
<link rel="preload" href="/35.4245364f.js" as="script">
<link rel="preload" href="/38.4429ce69.js" as="script">
<link rel="preload" href="/935f2afb.c9ec437b.js" as="script">
<link rel="preload" href="/17896441.c1139e0d.js" as="script">
<link rel="preload" href="/a54bd0b8.bde6df0e.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/thm-white.png" alt="TryHackMe Logo"><strong class="navbar__title">TryHackMe Documentation</strong></a><a class="navbar__item navbar__link" href="/docs/general/welcome">Docs</a><a href="https://blog.tryhackme.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tryhackmeltd/docs.tryhackme.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">âŒ˜</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/thm-white.png" alt="TryHackMe Logo"><strong class="navbar__title">TryHackMe Documentation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/general/welcome">Docs</a></li><li class="menu__list-item"><a href="https://blog.tryhackme.com" target="_blank" rel="noopener noreferrer" class="menu__link">Blog</a></li><li class="menu__list-item"><a href="https://github.com/tryhackmeltd/docs.tryhackme.com" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">General</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/welcome">Welcome to TryHackMe</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/what-is-tryhackme">What is TryHackMe?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/why-should-i-join">Why should I join?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/tryhackme-levels">TryHackMe Levels</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/general/researching-and-asking-for-help">The &quot;Researching Attitude&quot; and Asking for Help</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">OpenVPN</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/openvpn/why-openvpn">Why do I Need OpenVPN?</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Connecting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/openvpn/connecting/openvpn-connecting">Connecting With OpenVPN</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Troubleshooting</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/openvpn/troubleshooting/openvpn-troubleshooting">OpenVPN Troubleshooting</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Completing Rooms</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/rooms/what-are-rooms">What are Rooms?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/rooms/how-points-work">How Points Work</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/rooms/accessing-deployed-vms">Accessing Deployed VMs</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/rooms/room-difficulty-levels">Room Difficulty Levels</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Room Creation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/room-creation/room-creation-getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/room-creation/the-review-process">The Review Process</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Sales and Billing</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sales-billing/sales-billing-student">Student Discount</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/sales-billing/sales-billing-corporate">Corporate</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Teaching</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/teaching/teaching-getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/teaching/why-choose-us">Why Choose Us</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/teaching/reviews-and-feedback">Reviews And Feedback</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/teaching/contact-us">Contact Us</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Discord</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/discord/discord-getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/discord/verify">Verifying your Level</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">King Of The Hill (KOTH)</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/koth/king-of-the-hill">King of the Hill</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-docs/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/api-docs/api-endpoints">API Endpoints</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">OpenVPN Troubleshooting</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="using-the-thm-troubleshooting-script"></a>Using the THM troubleshooting Script:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#using-the-thm-troubleshooting-script" title="Direct link to heading">#</a></h2><p><a href="https://tryhackme.com/p/MuirlandOracle" target="_blank" rel="noopener noreferrer"><strong>MuirlandOracle</strong></a> has created a handy troubleshooting script for Linux that automates a large portion of the troubleshooting process for you. You can download it from <a href="https://github.com/tryhackme/openvpn-troubleshooting" target="_blank" rel="noopener noreferrer"><strong>TryHackMe&#x27;s Github</strong></a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="other-considerations"></a>Other Considerations:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#other-considerations" title="Direct link to heading">#</a></h2><p>As it stands, TryHackMe only supports OpenVPN via UDP. If you are in a country such as Egypt or China where a VPN over UDP is blocked, until TCP is supported, the alternative is to <a href="https://tryhackme.com/my-machine" target="_blank" rel="noopener noreferrer"><strong>deploy your own Kali instance</strong></a> in the cloud. This instance is hosted on TryHackMe and is publicly accessible without a VPN connection. </p><p>If you see messages relating to TLS errors, go to <a href="https://openvpn.net/faq/tls-error-tls-key-negotiation-failed-to-occur-within-60-seconds-check-your-network-connectivity/" target="_blank" rel="noopener noreferrer"><strong>this OpenVPN article</strong></a>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="not-receiving-reverse-shells-or-metasploit-not-creating-sessions"></a>Not receiving reverse shells or Metasploit not creating Sessions?<a aria-hidden="true" tabindex="-1" class="hash-link" href="#not-receiving-reverse-shells-or-metasploit-not-creating-sessions" title="Direct link to heading">#</a></h2><p>This is most commonly due to incorrect exploit settings within Metasploit / exploit code. This should be the first thing to check. Ensure that you are using your THM IP address as your <code>lhost</code> option and the IP address of the instance assigned to you as your <code>rhosts</code>.</p><p>Another possibility is people connecting via the OpenVPN on their host machine and not through their virtual machine. For example, running Kali Linux in Virtualbox on your Windows 10 PC. Ensure you are connecting via one session on Kali, rather than your Windows 10 PC.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="intermittent-connection-random-drop-outs"></a>Intermittent connection (random drop-outs):<a aria-hidden="true" tabindex="-1" class="hash-link" href="#intermittent-connection-random-drop-outs" title="Direct link to heading">#</a></h2><p>This issue usually stems from client-side issues that can be checked using the <a href="https://github.com/tryhackme/openvpn-troubleshooting" target="_blank" rel="noopener noreferrer"><strong>troubleshooting script</strong></a>. However, look for external factors to OpenVPN as to why you are experiencing issues if this script does not help.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="external-access-not-working"></a>External access not working:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#external-access-not-working" title="Direct link to heading">#</a></h2><p>When importing the OpenVPN configuration file into the Kali Linux GUI, kali will route all internet traffic through the VPN by default. In this case you won&#x27;t be able to contact external sites (e.g. &#x27;apt update&#x27; doesn&#x27;t work), but you can connect to resources on the THM network. Run the following to address the problem:</p><div class="mdxCodeBlock_1XEh"><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd">Copy</button><div tabindex="0" class="prism-code language-sh codeBlock_3iAC"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $ nmcli connection   # Note the name of the VPN connection here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  $ nmcli connection edit (connection_name)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &gt; set ipv4.never-default true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &gt; set ipv6.never-default true</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &gt; save</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  &gt; quit</span></div></div></div></div></div><p><a href="https://blog.djsdev.com/2020/03/add-htb-vpn-to-kali-20201-and-fix-vpn.html" target="_blank" rel="noopener noreferrer">Credit: Caleb Stewart</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="checking-for-external-issues"></a>Checking for external Issues:<a aria-hidden="true" tabindex="-1" class="hash-link" href="#checking-for-external-issues" title="Direct link to heading">#</a></h3><ol><li>In this setup, OpenVPN does not route all of your internet traffic through TryHackMe - are you able to connect to external websites like google? If not, this is an issue with your internet service</li><li>Are you using WiFi? Perhaps there could be interference or distancing issues resulting in a weak signal that would disrupt connectivity.</li><li>Are you in a country that blocks OpenVPN traffic? (China, Egypt)</li></ol><p>Finally, if you are confident that your internet connection is stable, try switching VPN servers via the <a href="https://tryhackme.com/access" target="_blank" rel="noopener noreferrer"><strong>access page</strong></a>.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/tryhackmeltd/docs.tryhackme.com/edit/master/docs/openvpn/troubleshooting/troubleshooting.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-04-29T00:18:15.000Z" class="docLastUpdatedAt_217_">4/29/2021</time> by <strong>Tony Kolstee</strong></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/openvpn/connecting/openvpn-connecting"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Connecting With OpenVPN</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/rooms/what-are-rooms"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">What are Rooms Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3SO_"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#using-the-thm-troubleshooting-script" class="table-of-contents__link">Using the THM troubleshooting Script:</a></li><li><a href="#other-considerations" class="table-of-contents__link">Other Considerations:</a></li><li><a href="#not-receiving-reverse-shells-or-metasploit-not-creating-sessions" class="table-of-contents__link">Not receiving reverse shells or Metasploit not creating Sessions?</a></li><li><a href="#intermittent-connection-random-drop-outs" class="table-of-contents__link">Intermittent connection (random drop-outs):</a></li><li><a href="#external-access-not-working" class="table-of-contents__link">External access not working:</a><ul><li><a href="#checking-for-external-issues" class="table-of-contents__link">Checking for external Issues:</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">About</h4><ul class="footer__items"><li class="footer__item"><a href="https://tryhackme.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">TryHackMe Website</a></li><li class="footer__item"><a href="https://blog.tryhackme.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://discord.gg/tryhackme" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li><li class="footer__item"><a href="https://tryhackme.com/forum" target="_blank" rel="noopener noreferrer" class="footer__link-item">Forums</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/tryhackmeltd/docs.tryhackme.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li><li class="footer__item"><a href="https://twitter.com/RealTryHackMe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://instagram.com/RealTryHackMe" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram</a></li></ul></div></div><div class="text--center"><div>Copyright Â© 2021 TryHackMe, Ltd. All rights reserved.</div></div></div></footer></div>
<script src="/styles.6be1d236.js"></script>
<script src="/runtime~main.40f7df4b.js"></script>
<script src="/main.8aab2a65.js"></script>
<script src="/1.e2bdedb4.js"></script>
<script src="/2.4507b645.js"></script>
<script src="/35.4245364f.js"></script>
<script src="/38.4429ce69.js"></script>
<script src="/935f2afb.c9ec437b.js"></script>
<script src="/17896441.c1139e0d.js"></script>
<script src="/a54bd0b8.bde6df0e.js"></script>
</body>
</html>